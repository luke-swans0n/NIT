#!/usr/bin/env python
# coding: utf-8
# # CAPSTONE TWO: NEGATIVE INCOME TAX EXPERIMENTS
# ## IMPORTS
# ## THE PERSON FILE
# We need to read in the person file, which contains the target data as well as other data, and merge it with the family file which contains the treatment level and the poverty level.
# GARY_FILE_PERSON_RECORD'
import pandas as pd
import numpy as np

GARY_FILE_PERSON_RECORD_PATH = "data/raw/ca033001.dat"
var_list = [
    "FAMNUM",
    "PERNUM",
    "STATUS1-48",
    "MOPRES1-48",
    "MRST1-48",
    "RELCODE1-48",
    "DOB",
    "SEX",
    "ENRLDATE",
    "ATTDATE",
    "DENRLDAT",
    "GRADE71",
    "SCHTYP71",
    "GRADE72",
    "SCHTYP72",
    "GRADE73",
    "SCHTYP73",
    "EVEREMP",
    "FAMBUS",
    "YRSTWRK",
    "YRFTWRK",
    "JOBTOTAL",
    "JOBS5YRS",
    "JOBS3YRS",
    "JOBS1YR",
    "INCOME69",
    "EMPLOYED",
    "LABRSTAT",
    "MONTHS",
    "INDUSTRY",
    "OCCUPA",
    "HRSVARY",
    "SEASON",
    "RCNTHRS",
    "RCNTOT",
    "RCNTWAGR",
    "RCNTOTR",
    "RCNTPAY",
    "NRMLHRS",
    "NRMLOT",
    "NRMLWAGR",
    "NRMLOTR",
    "NRMLPAY",
    "DAYHRSR",
    "DAYRATER",
    "DAYPAYR",
    "DAYHRSN",
    "DAYRATEN",
    "DAYPAYN",
    "MOSNOWRK",
    "PLANWORK",
    "SSI1-48",
    "TTI1-48",
    "SS1-48",
    "VA1-48",
    "MISINC1-48",
    "OTHINC1-48",
    "JOBSINC1-48",
    "DAYINC1-48",
    "OJINC1-48",
    "UEMBEN1-48",
    "STRKWC1-48",
    "EMPSTAT1-9",
    "TYPWRKR1-9",
    "WYNOWRK1-9",
    "HRSWEEK1-9",
    "OTHRSWK1-9",
    "HRSREG1-9",
    "OTHREG1-9",
    "DSABLED1-9",
    "DISLMIT1-9",
    "TYPWRK1-48",
    "PCTEMP1-48",
    "PCTWRK1-48",
    "REASON1-48",
    "PCNTLF1-48",
    "PCTUMP1-48",
    "EMPSTA1-48",
    "DISABL1-48",
    "NUMJBS1-48",
    "EXPER1-48",
    "INDUS1-48",
    "OCCUP1-48",
    "WKRLNG1-48",
    "HOURS1-48",
    "HRCHNG1-48",
    "OTHRS1-48",
    "WGRATE1-48",
    "WGCHNG1-48",
    "SINWGS69-73",
    "SJTWGS69-73",
    "WAGES70",
    "QTRWRK70",
    "WGSECON",
    "WGSART1-16",
    "UNEMP1-48",
    "OTRATE1-48",
    "GWAGES0-42",
    "FTXWTH0-42",
    "STXWTH0-42",
    "FICA0-42",
    "JOBS0-42",
    "HRSWRK0-42",
    "REGHRS0-42",
    "OVRTME0-42",
    "SPECL0-42",
    "SPCLCD0-42",
    "AFDC1970",
    "AFDCM070",
    "AFDCBASE",
    "AFDC1-48",
    "AFDCEL1-48",
    "SSI1970",
    "SSIMOS70",
    "SSIBASE",
]
data_set = []
with open(GARY_FILE_PERSON_RECORD_PATH) as file:
    for line in file:
        data = [
            str(line[1 - 1: 4]),
            str(line[5 - 1: 10]),
            str(line[11 - 1: 106]),
            str(line[107 - 1: 154]),
            str(line[155 - 1: 250]),
            str(line[251 - 1: 346]),
            str(line[347 - 1: 350]),
            str(line[350]),
            str(line[352 - 1: 356]),
            str(line[357 - 1: 361]),
            str(line[362 - 1: 366]),
            str(line[367 - 1: 368]),
            str(line[369 - 1: 370]),
            str(line[371 - 1: 372]),
            str(line[373 - 1: 374]),
            str(line[375 - 1: 376]),
            str(line[377 - 1: 378]),
            str(line[380 - 1: 381]),
            str(line[382 - 1: 383]),
            str(line[384 - 1: 385]),
            str(line[386 - 1: 387]),
            str(line[388 - 1: 389]),
            str(line[390 - 1: 391]),
            str(line[392 - 1: 393]),
            str(line[394 - 1: 395]),
            str(line[396 - 1: 400]),
            str(line[401 - 1: 402]),
            str(line[403 - 1: 404]),
            str(line[405 - 1: 407]),
            str(line[408 - 1: 410]),
            str(line[411 - 1: 413]),
            str(line[414 - 1: 415]),
            str(line[416 - 1: 417]),
            str(line[418 - 1: 420]),
            str(line[421 - 1: 422]),
            str(line[423 - 1: 426]),
            str(line[427 - 1: 430]),
            str(line[431 - 1: 436]),
            str(line[437 - 1: 439]),
            str(line[440 - 1: 441]),
            str(line[442 - 1: 445]),
            str(line[446 - 1: 449]),
            str(line[449:455]),
            str(line[456 - 1: 458]),
            str(line[459 - 1: 462]),
            str(line[463 - 1: 468]),
            str(line[469 - 1: 471]),
            str(line[472 - 1: 475]),
            str(line[476 - 1: 481]),
            str(line[482 - 1: 483]),
            str(line[484 - 1: 485]),
            str(line[500 - 1: 691]),
            str(line[692 - 1: 883]),
            str(line[884 - 1: 1075]),
            str(line[1076 - 1: 1267]),
            str(line[1268 - 1: 1459]),
            str(line[1460 - 1: 1651]),
            str(line[1652 - 1: 1843]),
            str(line[1844 - 1: 2035]),
            str(line[2036 - 1: 2227]),
            str(line[2228 - 1: 2419]),
            str(line[2420 - 1: 2611]),
            str(line[2612 - 1: 2629]),
            str(line[2630 - 1: 2647]),
            str(line[2648 - 1: 2665]),
            str(line[2666 - 1: 2692]),
            str(line[2693 - 1: 2719]),
            str(line[2720 - 1: 2746]),
            str(line[2747 - 1: 2773]),
            str(line[2774 - 1: 2791]),
            str(line[2792 - 1: 2809]),
            str(line[2810 - 1: 2905]),
            str(line[2906 - 1: 3097]),
            str(line[3098 - 1: 3289]),
            str(line[3290 - 1: 3385]),
            str(line[3386 - 1: 3577]),
            str(line[3578 - 1: 3769]),
            str(line[3770 - 1: 3865]),
            str(line[3866 - 1: 3961]),
            str(line[3962 - 1: 4057]),
            str(line[4058 - 1: 4201]),
            str(line[4202 - 1: 4345]),
            str(line[4346 - 1: 4537]),
            str(line[4538 - 1: 4729]),
            str(line[4730 - 1: 4921]),
            str(line[4922 - 1: 5017]),
            str(line[5018 - 1: 5209]),
            str(line[5210 - 1: 5401]),
            str(line[5402 - 1: 5497]),
            str(line[8415 - 1: 8444]),
            str(line[8445 - 1: 8474]),
            str(line[8475 - 1: 8479]),
            str(line[8480 - 1: 8481]),
            str(line[8482 - 1: 8485]),
            str(line[8486 - 1: 8549]),
            str(line[8550 - 1: 8741]),
            str(line[5498 - 1: 5593]),
            str(line[5594 - 1: 5765]),
            str(line[5766 - 1: 5937]),
            str(line[5938 - 1: 6109]),
            str(line[6110 - 1: 6281]),
            str(line[6282 - 1: 6496]),
            str(line[6497 - 1: 6582]),
            str(line[6583 - 1: 6754]),
            str(line[6927 - 1: 7098]),
            str(line[7099 - 1: 7270]),
            str(line[7271 - 1: 7356]),
            str(line[7357 - 1: 7360]),
            str(line[7361 - 1: 7362]),
            str(line[7363 - 1: 7366]),
            str(line[7367 - 1: 7558]),
            str(line[7559 - 1: 7750]),
            str(line[7751 - 1: 7754]),
            str(line[7755 - 1: 7756]),
            str(line[7757 - 1: 7760]),
        ]
        data_set.append(data)
# In[3]:
person_df = pd.DataFrame(np.array(data_set), columns=var_list)
# ## THE FAMILY FILE
# In[4]:
var_list = ["FAMNUM", "POVLEV", "TREATLEV"]
data_set = []
with open("../../data/raw/ca033002.dat") as file:
    for line in file:
        data = [line[0:4], line[6], line[8]]
        data_set.append(data)
# In[5]:
fam_df = pd.DataFrame(np.array(data_set), columns=var_list)
# ## MERGING
# We use an outer merge here to collect all of the entries from both tables.
# In[6]:
fam_df.FAMNUM.astype(int)
person_df.FAMNUM.astype(int)
gary_df = person_df.merge(fam_df, on="FAMNUM", how="outer")
gary_df.to_csv("raw_gary_df.csv")
